<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script>
      const loadPage = () => {
        window.location.href = window.electronAPI.baseURL;
      };

      // Si entramos a la app de escritorio dejamos escrito que ya la tenemos cacheada => podremos entrar de manera totalmente offline
      // FIXME: when entering the login page we don't really have the web cached. We should set the cached to true only
      // when we enter the main page
      const onLoad = () => {
        debugger;
        console.info("loading");
        document.getElementById("offline").style.display = "none";
        if (localStorage.getItem("cached")) {
          loadPage();
        } else {
          console.info("mostramos offline");
          fetch(window.electronAPI.baseURL)
            .then(() => {
              localStorage.setItem("cached", 1);
              loadPage();
            })
            .catch(() => {
              console.info("mostramos error");
              document.getElementById("offline").style.display = "block";
            });
        }
      };
    </script>
  </head>

  <body onload="onLoad()">
    <div id="offline" style="font-size: 50px; color: white; display: none">
      OFFLINE Y TAL
      <button onClick="onLoad(); return false;">Reintentar</button>
    </div>
  </body>
</html>
